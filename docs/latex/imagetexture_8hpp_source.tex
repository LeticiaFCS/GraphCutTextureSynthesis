\doxysection{imagetexture.\+hpp}
\hypertarget{imagetexture_8hpp_source}{}\label{imagetexture_8hpp_source}\index{/home/leticiafcs/tcc/GraphCutTextureSynthesis/code/imagetexture.hpp@{/home/leticiafcs/tcc/GraphCutTextureSynthesis/code/imagetexture.hpp}}
\mbox{\hyperlink{imagetexture_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00012\ \textcolor{preprocessor}{\#include\ <png++/png.hpp>}}
\DoxyCodeLine{00013\ \textcolor{preprocessor}{\#include\ <algorithm>}}
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ <math.h>}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ <utility>}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ <array>}}
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#include\ <queue>}}
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#include\ <tuple>}}
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#include\ <map>}}
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#include\ <random>}}
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#include\ <chrono>}}
\DoxyCodeLine{00022\ \textcolor{preprocessor}{\#include\ <cassert>}}
\DoxyCodeLine{00023\ \textcolor{preprocessor}{\#include\ <unistd.h>}\ \textcolor{comment}{//just\ for\ debug}}
\DoxyCodeLine{00024\ \textcolor{preprocessor}{\#include\ <cstdlib>}\ \textcolor{comment}{//\ just\ for\ debug}}
\DoxyCodeLine{00025\ \textcolor{preprocessor}{\#include\ <iomanip>}\ \textcolor{comment}{//\ just\ for\ debug}}
\DoxyCodeLine{00026\ \textcolor{preprocessor}{\#include\ <string>}}
\DoxyCodeLine{00027\ }
\DoxyCodeLine{00032\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classImageTexture}{ImageTexture}}\{}
\DoxyCodeLine{00033\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00041\ \ \ \ \ \mbox{\hyperlink{classImageTexture}{ImageTexture}}(\textcolor{keyword}{const}\ png::image<png::rgb\_pixel>\ \&\ \_img);}
\DoxyCodeLine{00042\ }
\DoxyCodeLine{00051\ \ \ \ \ \mbox{\hyperlink{classImageTexture}{ImageTexture}}(\textcolor{keywordtype}{int}\ width,\ \textcolor{keywordtype}{int}\ height);}
\DoxyCodeLine{00052\ }
\DoxyCodeLine{00060\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classImageTexture_abd02657ca56f7c6c8c227568f89e55b9}{patchFittingIteration}}(\textcolor{keyword}{const}\ png::image<png::rgb\_pixel>\ \&inputImg);}
\DoxyCodeLine{00061\ }
\DoxyCodeLine{00069\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classImageTexture_abd02657ca56f7c6c8c227568f89e55b9}{patchFittingIteration}}(\textcolor{keyword}{const}\ std::string\ \&file\_name);}
\DoxyCodeLine{00070\ }
\DoxyCodeLine{00079\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classImageTexture_aab63831b31d53be8bc3fc55d50d9b183}{patchFitting}}(\textcolor{keyword}{const}\ png::image<png::rgb\_pixel>\ \&inputImg,\ \textcolor{keywordtype}{int}\ CntIterations\ =\ 100000);}
\DoxyCodeLine{00080\ }
\DoxyCodeLine{00089\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classImageTexture_aab63831b31d53be8bc3fc55d50d9b183}{patchFitting}}(\textcolor{keyword}{const}\ std::string\ \&file\_name,\ \textcolor{keywordtype}{int}\ CntIterations\ =\ 100000);}
\DoxyCodeLine{00090\ }
\DoxyCodeLine{00100\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classImageTexture_ac749512804a911f551b54fa74754d6ea}{blending}}(\textcolor{keywordtype}{int}\ heightOffset,\ \textcolor{keywordtype}{int}\ widthOffset,\ \textcolor{keyword}{const}\ png::image<png::rgb\_pixel>\ \&inputImg);}
\DoxyCodeLine{00101\ }
\DoxyCodeLine{00111\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classImageTexture_ac749512804a911f551b54fa74754d6ea}{blending}}(\textcolor{keywordtype}{int}\ heightOffset,\ \textcolor{keywordtype}{int}\ widthOffset,\ \textcolor{keyword}{const}\ std::string\ \&file\_name);}
\DoxyCodeLine{00112\ \ \ \ \ }
\DoxyCodeLine{00120\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classImageTexture_a019036d96f5e6c6d7cd09f969fa70f35}{render}}(\textcolor{keyword}{const}\ std::string\ \&file\_name);}
\DoxyCodeLine{00121\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00122\ \ \ \ \ \textcolor{keyword}{const}\ uint64\_t\ rngSeed;}
\DoxyCodeLine{00123\ \ \ \ \ std::mt19937\_64\ rng;}
\DoxyCodeLine{00124\ \ \ \ \ \textcolor{keyword}{enum}\ PixelStatusEnum\{}
\DoxyCodeLine{00125\ \ \ \ \ \ \ \ \ colored,\ intersection,\ newcolor,\ notcolored}
\DoxyCodeLine{00126\ \ \ \ \ \};}
\DoxyCodeLine{00127\ \ \ \ \ \textcolor{keyword}{enum}\ edgeType\{}
\DoxyCodeLine{00128\ \ \ \ \ \ \ \ \ originalGraph,\ copyGraph,\ invalid}
\DoxyCodeLine{00129\ \ \ \ \ \};}
\DoxyCodeLine{00130\ \ \ \ \ png::image<png::rgb\_pixel>\ outputImg;}
\DoxyCodeLine{00131\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ imgWidth;}
\DoxyCodeLine{00132\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ imgHeight;}
\DoxyCodeLine{00133\ \ \ \ \ std::vector<std::vector<PixelStatusEnum>>\ pixelColorStatus;}
\DoxyCodeLine{00134\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{long}\ \textcolor{keywordtype}{double}\ inftyCost\ =\ 10000000;}
\DoxyCodeLine{00135\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ std::array<std::pair<int,\ int>,\ 4>\ directions\ =\ \{\{}
\DoxyCodeLine{00136\ \ \ \ \ \ \ \ \ \{-\/1,\ 0\},\ \ \ \ \textcolor{comment}{//\ \ \ \ |0|}}
\DoxyCodeLine{00137\ \ \ \ \ \ \ \ \ \{\ 0,-\/1\},\ \ \ \ \textcolor{comment}{//\ \ |1|x|3|}}
\DoxyCodeLine{00138\ \ \ \ \ \ \ \ \ \{\ 1,\ 0\},\ \ \ \ \textcolor{comment}{//\ \ \ \ |2|}}
\DoxyCodeLine{00139\ \ \ \ \ \ \ \ \ \{\ 0,\ 1\}\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00140\ \ \ \ \ \}\};}
\DoxyCodeLine{00141\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ std::array<std::pair<int,\ int>,\ 4>\ primalToDual\ =\ \{\{}
\DoxyCodeLine{00142\ \ \ \ \ \ \ \ \ \{\ 0,\ 0\},\ \ \ \ \textcolor{comment}{//\ \ 0\_3}}
\DoxyCodeLine{00143\ \ \ \ \ \ \ \ \ \{\ 1,\ 0\},\ \ \ \ \textcolor{comment}{//\ \ |\ |}}
\DoxyCodeLine{00144\ \ \ \ \ \ \ \ \ \{\ 1,\ 1\},\ \ \ \ \textcolor{comment}{//\ \ 1\_2}}
\DoxyCodeLine{00145\ \ \ \ \ \ \ \ \ \{\ 0,\ 1\}\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00146\ \ \ \ \ \}\};}
\DoxyCodeLine{00147\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ std::array<std::pair<int,\ int>,\ 4>\ dualToPrimal\ =\ \{\{}
\DoxyCodeLine{00148\ \ \ \ \ \ \ \ \ \{-\/1,-\/1\},\ \ \ \ \textcolor{comment}{//\ \ 0|3}}
\DoxyCodeLine{00149\ \ \ \ \ \ \ \ \ \{\ 0,-\/1\},\ \ \ \ \textcolor{comment}{//\ \ -\/*-\/}}
\DoxyCodeLine{00150\ \ \ \ \ \ \ \ \ \{\ 0,\ 0\},\ \ \ \ \textcolor{comment}{//\ \ 1|2\ }}
\DoxyCodeLine{00151\ \ \ \ \ \ \ \ \ \{-\/1,\ 0\}\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00152\ \ \ \ \ \}\};}
\DoxyCodeLine{00153\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{int}\ nextDir(\textcolor{keywordtype}{int}\ i);}
\DoxyCodeLine{00154\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{int}\ prevDir(\textcolor{keywordtype}{int}\ i);}
\DoxyCodeLine{00155\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{int}\ revDir(\textcolor{keywordtype}{int}\ i);}
\DoxyCodeLine{00156\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{long}\ \textcolor{keywordtype}{double}\ pow2(\textcolor{keywordtype}{long}\ \textcolor{keywordtype}{double}\ x);}
\DoxyCodeLine{00157\ \ \ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ Pixel>}
\DoxyCodeLine{00158\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{long}\ \textcolor{keywordtype}{double}\ calcCost(\textcolor{keyword}{const}\ Pixel\ \&as,\ \textcolor{keyword}{const}\ Pixel\ \&bs,\ \textcolor{keyword}{const}\ Pixel\ \&at,\ \textcolor{keyword}{const}\ Pixel\ \&bt);}
\DoxyCodeLine{00159\ \ \ \ \ }
\DoxyCodeLine{00160\ \ \ \ \ std::pair<int,\ int>\ matching(\textcolor{keyword}{const}\ png::image<png::rgb\_pixel>\ \&inputImg);}
\DoxyCodeLine{00161\ \ \ \ \ \textcolor{keywordtype}{bool}\ isFirstPatch(\textcolor{keywordtype}{int}\ heightOffset,\ \textcolor{keywordtype}{int}\ widthOffset,\ \textcolor{keyword}{const}\ png::image<png::rgb\_pixel>\ \&inputImg);}
\DoxyCodeLine{00162\ \ \ \ \ \textcolor{keywordtype}{void}\ copyFirstPatch(\textcolor{keywordtype}{int}\ heightOffset,\ \textcolor{keywordtype}{int}\ widthOffset,\ \textcolor{keyword}{const}\ png::image<png::rgb\_pixel>\ \&inputImg);}
\DoxyCodeLine{00163\ \ \ \ \ \textcolor{keywordtype}{bool}\ stPlanarGraph(\textcolor{keywordtype}{int}\ heightOffset,\ \textcolor{keywordtype}{int}\ widthOffset,\ \textcolor{keyword}{const}\ png::image<png::rgb\_pixel>\ \&inputImg);}
\DoxyCodeLine{00164\ \ \ \ \ \textcolor{keywordtype}{void}\ blendingCase1(\textcolor{keywordtype}{int}\ heightOffset,\ \textcolor{keywordtype}{int}\ widthOffset,\ \textcolor{keyword}{const}\ png::image<png::rgb\_pixel>\ \&inputImg);}
\DoxyCodeLine{00165\ \ \ \ \ \textcolor{keywordtype}{void}\ blendingCase2(\textcolor{keywordtype}{int}\ heightOffset,\ \textcolor{keywordtype}{int}\ widthOffset,\ \textcolor{keyword}{const}\ png::image<png::rgb\_pixel>\ \&inputImg);}
\DoxyCodeLine{00166\ }
\DoxyCodeLine{00167\ \ \ \ \ \textcolor{keywordtype}{void}\ copyPixelsNewColor(\textcolor{keywordtype}{int}\ heightOffset,\ \textcolor{keywordtype}{int}\ widthOffset,\ \textcolor{keyword}{const}\ png::image<png::rgb\_pixel>\ \&inputImg,\ \textcolor{keywordtype}{bool}\ case2\ =\ \textcolor{keyword}{false});}
\DoxyCodeLine{00168\ \ \ \ \ \textcolor{keywordtype}{bool}\ inImgBorder(\textcolor{keywordtype}{int}\ i,\ \textcolor{keywordtype}{int}\ j,\ \textcolor{keywordtype}{int}\ heightOffset,\ \textcolor{keywordtype}{int}\ widthOffset,\ \textcolor{keyword}{const}\ png::image<png::rgb\_pixel>\ \&inputImg);\ \ \ \ }
\DoxyCodeLine{00169\ \ \ \ \ \textcolor{keywordtype}{bool}\ insidePrimal(\textcolor{keywordtype}{int}\ i,\ \textcolor{keywordtype}{int}\ j);\ \ }
\DoxyCodeLine{00170\ \ \ \ \ \textcolor{keywordtype}{bool}\ insideDual(\textcolor{keywordtype}{int}\ i,\ \textcolor{keywordtype}{int}\ j);}
\DoxyCodeLine{00171\ \ \ \ \ \textcolor{keywordtype}{bool}\ insideImg(\textcolor{keywordtype}{int}\ i,\ \textcolor{keywordtype}{int}\ j,\ \textcolor{keyword}{const}\ png::image<png::rgb\_pixel>\ \&img);}
\DoxyCodeLine{00172\ \ \ \ \ \textcolor{keyword}{class\ }Intersection\{}
\DoxyCodeLine{00173\ \ \ \ \ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00174\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ counter\ clockwise,\ starting\ with\ upper\ neighbor}}
\DoxyCodeLine{00175\ \ \ \ \ \ \ \ \ \ \ \ \ std::vector<std::pair<int,\ int>>\ interPixels;}
\DoxyCodeLine{00176\ \ \ \ \ \ \ \ \ \ \ \ \ Intersection(\textcolor{keyword}{const}\ std::vector<std::pair<int,int>>\ \&pixels\ =\ \{\});}
\DoxyCodeLine{00177\ \ \ \ \ \};}
\DoxyCodeLine{00178\ \ \ \ \ }
\DoxyCodeLine{00179\ \ \ \ \ \textcolor{comment}{//Case\ 1\ auxiliar\ variables}}
\DoxyCodeLine{00180\ \ \ \ \ std::vector<std::vector<bool>>\ inSubgraph;}
\DoxyCodeLine{00181\ \ \ \ \ std::vector<std::vector<std::array<long\ double,\ 4>>>\ edgesCosts;\ \ \ \ }
\DoxyCodeLine{00182\ \ \ \ \ std::vector<std::vector<long\ double>>\ dist;}
\DoxyCodeLine{00183\ \ \ \ \ std::vector<std::vector<bool>>\ vis;}
\DoxyCodeLine{00184\ \ \ \ \ std::vector<std::vector<int>>\ parent;}
\DoxyCodeLine{00185\ \ \ \ \ std::vector<std::vector<std::array<bool,\ 4>>>\ validEdge;}
\DoxyCodeLine{00186\ \ \ \ \ std::vector<std::vector<bool>>\ isT;}
\DoxyCodeLine{00187\ \ \ \ \ std::vector<std::vector<bool>>\ isS;}
\DoxyCodeLine{00188\ }
\DoxyCodeLine{00189\ \ \ \ \ \textcolor{comment}{//Case\ 1\ auxiliar\ methods}}
\DoxyCodeLine{00190\ \ \ \ \ std::pair<std::pair<int,\ int>,\ std::pair<int,\ int>\ >\ findSTInIntersectionCase1(Intersection\ \&inter,\ \textcolor{keywordtype}{int}\ heightOffset,\ \textcolor{keywordtype}{int}\ widthOffset,\ \textcolor{keyword}{const}\ png::image<png::rgb\_pixel>\ \&inputImg);}
\DoxyCodeLine{00191\ \ \ \ \ std::vector<Intersection>\ findIntersections(\textcolor{keywordtype}{int}\ heightOffset,\ \textcolor{keywordtype}{int}\ widthOffset,\ \textcolor{keyword}{const}\ png::image<png::rgb\_pixel>\ \&inputImg);}
\DoxyCodeLine{00192\ \ \ \ \ \textcolor{keywordtype}{void}\ markMinABCut(std::pair<int,\ int>\ S,\ std::pair<int,\ int>\ T,\ \textcolor{keyword}{const}\ ImageTexture::Intersection\ \&inter,\ \textcolor{keywordtype}{int}\ heightOffset,\ \textcolor{keywordtype}{int}\ widthOffset,\ \textcolor{keyword}{const}\ png::image<png::rgb\_pixel>\ \&inputImg);}
\DoxyCodeLine{00193\ \ \ \ \ \textcolor{comment}{//MarkMinABCut\ auxiliar\ methods}}
\DoxyCodeLine{00194\ \ \ \ \ std::vector<std::pair<int,\ int>>\ markIntersectionCellsInDual(\textcolor{keyword}{const}\ ImageTexture::Intersection\ \&inter);}
\DoxyCodeLine{00195\ \ \ \ \ \textcolor{keywordtype}{void}\ markIntersectionEdgeCostsInDual(\textcolor{keywordtype}{int}\ heightOffset,\ \textcolor{keywordtype}{int}\ widthOffset,\ \textcolor{keyword}{const}\ png::image<png::rgb\_pixel>\ \&inputImg,\ \textcolor{keyword}{const}\ std::vector<std::pair<int,\ int>>\ \&inDual);}
\DoxyCodeLine{00196\ \ \ \ \ std::vector<std::pair<int,int>>\ findSTPath(\textcolor{keyword}{const}\ std::vector<std::pair<int,int>>\ \&S,\ \textcolor{keyword}{const}\ std::vector<std::pair<int,int>>\ \&T);}
\DoxyCodeLine{00197\ \ \ \ \ \textcolor{keywordtype}{void}\ markLeftOfMinCut(\textcolor{keyword}{const}\ std::vector<std::pair<int,\ int>>\ \&cut);}
\DoxyCodeLine{00198\ \ \ \ \ }
\DoxyCodeLine{00199\ \ \ \ \ \textcolor{comment}{//Case\ 2\ auxiliar\ variables}}
\DoxyCodeLine{00200\ \ \ \ \ std::vector<std::vector<bool>>\ inS;}
\DoxyCodeLine{00201\ \ \ \ \ std::vector<std::vector<int>>\ inStPath;}
\DoxyCodeLine{00202\ \ \ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keyword}{static}\ std::array<int,\ 4>\ edgesToOriginalGraph\ =\ \{edgeType::originalGraph,edgeType::originalGraph,edgeType::originalGraph,edgeType::originalGraph\};}
\DoxyCodeLine{00203\ \ \ \ \ std::array<std::vector<std::vector<std::array<int,\ 4>>>,2>\ edgeTo;}
\DoxyCodeLine{00204\ \ \ \ \ std::array<std::vector<std::vector<long\ double>>,\ 2>\ distCase2;}
\DoxyCodeLine{00205\ \ \ \ \ std::array<std::vector<std::vector<int>>,\ 2>\ visCase2;}
\DoxyCodeLine{00206\ \ \ \ \ std::array<std::vector<std::vector<int>>,\ 2>\ seenCase2;}
\DoxyCodeLine{00207\ \ \ \ \ std::array<std::vector<std::vector<int>>,\ 2>\ parentCase2;}
\DoxyCodeLine{00208\ }
\DoxyCodeLine{00209\ \ \ \ \ \textcolor{comment}{//Case\ 2\ auxiliar\ functions}}
\DoxyCodeLine{00210\ \ \ \ \ std::vector<std::pair<int,\ int>>\ dualBorder(\textcolor{keywordtype}{int}\ heightOffset,\ \textcolor{keywordtype}{int}\ widthOffset,\ \textcolor{keyword}{const}\ png::image<png::rgb\_pixel>\ \&inputImg);}
\DoxyCodeLine{00211\ \ \ \ \ std::vector<std::pair<int,\ int>>\ findSCase2(\textcolor{keywordtype}{int}\ heightOffset,\ \textcolor{keywordtype}{int}\ widthOffset,\ \textcolor{keyword}{const}\ png::image<png::rgb\_pixel>\ \&inputImg);}
\DoxyCodeLine{00212\ \ \ \ \ std::pair<long\ double,\ std::vector<std::array<int,3>>>\ minCutCycle(\textcolor{keywordtype}{int}\ left,\ \textcolor{keywordtype}{int}\ right,\ \textcolor{keyword}{const}\ std::vector<std::pair<int,\ int>>\ \&stPath,\ \textcolor{keywordtype}{int}\ \&visited);\ \ \ \ }
\DoxyCodeLine{00213\ \ \ \ \ std::pair<long\ double,\ std::vector<std::array<int,3>>>\ findMinFCycle(\textcolor{keyword}{const}\ std::pair<int,int>\ \&F,\ \textcolor{keywordtype}{int}\ visited);}
\DoxyCodeLine{00214\ \};}

\end{DoxyCode}
